
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>

<script type="module">
import { firebaseConfig } from './firebase-config.js';
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

const ADMIN_EMAIL="vivekghuge009@gmail.com";

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);
const storage=getStorage(app);

window.adminLogin=async function(){
  const user=await signInWithEmailAndPassword(auth,email.value,password.value);
  if(user.user.email!==ADMIN_EMAIL){ alert("Not Authorized"); return;}
  panel.style.display="block";
  loadProducts();
}

window.addProduct=async function(){
  const file=image.files[0];
  const storageRef=ref(storage,"products/"+file.name);
  await uploadBytes(storageRef,file);
  const url=await getDownloadURL(storageRef);

  await addDoc(collection(db,"products"),{
    name:pname.value,
    price:pprice.value,
    category:pcategory.value,
    meeshoLink:plink.value,
    imageURL:url
  });
  alert("Added");
  loadProducts();
}

async function loadProducts(){
  const snap=await getDocs(collection(db,"products"));
  let html="";
  snap.forEach(d=>{
    html+=`<p>${d.data().name} 
    <button onclick="deleteProduct('${d.id}')">Delete</button></p>`;
  });
  list.innerHTML=html;
}

window.deleteProduct=async function(id){
  await deleteDoc(doc(db,"products",id));
  loadProducts();
}
</script>

<style>
body{font-family:Arial;background:white;color:#0d47a1;text-align:center}
header{background:#0d47a1;color:white;padding:15px}
input{margin:5px;padding:6px}
button{padding:6px 10px;border:none;background:#0d47a1;color:white}
</style>
</head>

<body>
<header><h2>Admin Panel</h2></header>

<input id="email" placeholder="Admin Email"><br>
<input id="password" type="password" placeholder="Password"><br>
<button onclick="adminLogin()">Login</button>

<div id="panel" style="display:none">
<h3>Add Product</h3>
<input id="pname" placeholder="Name"><br>
<input id="pprice" placeholder="Price"><br>
<input id="pcategory" placeholder="Category"><br>
<input id="plink" placeholder="Meesho Link"><br>
<input id="image" type="file"><br>
<button onclick="addProduct()">Add</button>

<h3>Products</h3>
<div id="list"></div>
</div>

</body>
</html>
